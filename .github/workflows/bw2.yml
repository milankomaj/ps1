name: bw2

on:
  workflow_dispatch:
    
jobs:
 Generate_Wallpapers :
    runs-on: windows-latest
    timeout-minutes: 10
    steps:
    - uses: actions/checkout@v2
    - name: Generate Wallpaper Bing
      shell: powershell
      run: |
       $textToAdd = '$outpath = "./BingWallpaper"'
       $BingLineNumber = 42
       $fileContent = Get-Content ./executables/BING_2/bing-wallpaper.ps1
       $fileContent[$BingLineNumber-1] = $textToAdd
       $fileContent | Set-Content ./executables/BING_2/bing-wallpaper.ps1

       $textToAdd2 = ' <debug>true</debug>'
       $BingLineNumber2 = 11
       $fileContent2 = Get-Content ./executables/BING_2/SettingsBw.xml
       $fileContent2[$BingLineNumber2-1] = $textToAdd2
       $fileContent2 | Set-Content ./executables/BING_2/SettingsBw.xml
       
       Write-Output pred
       cd ./BingWallpaper
       dir -r | Select-Object Name,Length,LastWriteTime

       cd ..
       cd ./executables/BING_2/
       ./bing-wallpaper.ps1
       cd ..
       cd ..
       cd ./BingWallpaper
       Write-Output po
       dir -r  | Select-Object Name,Length,LastWriteTime
       Remove-Item latest.jpg
       Get-ChildItem *.jpg | Rename-Item -NewName { $_.Name -replace '.*.jpg','latest.jpg' }
       
       
       
    - name: Generate Wallpaper Himawari
      shell: pwsh
      run: |
       $textToAdd = '$outpath = "./Himawari/"'
       $HimawariLineNumber = 30
       $fileContent = Get-Content ./executables/Himawari/himawari.ps1
       $fileContent[$HimawariLineNumber-1] = $textToAdd
       $fileContent | Set-Content ./executables/Himawari/himawari.ps1

       
       Write-Output pred
       dir -r ./Himawari | Select-Object Name,Length,LastWriteTime
       ./executables/Himawari/himawari.ps1
       Write-Output po
       Get-ChildItem *.jpg | Rename-Item -NewName { $_.Name -replace '.*.jpg','latest.jpg' }
       dir -r ./Himawari | Select-Object Name,Length,LastWriteTime       